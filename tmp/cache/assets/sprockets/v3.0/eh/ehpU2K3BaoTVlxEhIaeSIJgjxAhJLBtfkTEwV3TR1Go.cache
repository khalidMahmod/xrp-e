I"d(function() {
  app.controller('WithdrawHistoryController', function($scope, $stateParams, $http) {
    var ctrl;
    ctrl = this;
    $scope.predicate = '-id';
    this.currency = $stateParams.currency;
    this.account = Account.findBy('currency', this.currency);
    this.withdraws = this.account.withdraws().slice(0, 3);
    this.newRecord = function(withdraw) {
      if (withdraw.aasm_state === "submitting") {
        return true;
      } else {
        return false;
      }
    };
    this.noWithdraw = function() {
      return this.withdraws.length === 0;
    };
    this.refresh = function() {
      ctrl.withdraws = ctrl.account.withdraws().slice(0, 3);
      return $scope.$apply();
    };
    this.canCancel = function(state) {
      return ['submitting', 'submitted', 'accepted'].indexOf(state) > -1;
    };
    this.cancelWithdraw = function(withdraw) {
      var withdraw_channel;
      withdraw_channel = WithdrawChannel.findBy('currency', withdraw.currency);
      return $http["delete"]("/withdraws/" + withdraw_channel.resource_name + "/" + withdraw.id).error(function(responseText) {
        return $.publish('flash', {
          message: responseText
        });
      });
    };
    return (this.event = function() {
      return Withdraw.bind("create update destroy", function() {
        return ctrl.refresh();
      });
    })();
  });

}).call(this);
:ET